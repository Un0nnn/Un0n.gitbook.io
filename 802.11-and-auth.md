# 802.11 & Auth

[**Direct link to heading**](802.11-and-auth.md#id-802.11-frames-and-types) **802.11 Frames and Types**

**Overview**

* 802.11 traffic uses different frame types for actions in the connection cycle.
* Frames can be **forged** for attacks like deauthentication or disassociation in Wi-Fi penetration testing.

[**Direct link to heading**](802.11-and-auth.md#mac-frame-structure) **MAC Frame Structure**

All 802.11 frames are based on the **MAC frame**, which has 9 fields:

1. **Frame Control** – type, subtype, protocol version, flags (To DS, From DS, Order).
2. **Duration/ID** – time the medium is occupied.
3. **Addresses 1–4** – MAC addresses; meanings vary by frame origin.
4. **Sequence Control (SC)** – prevents duplicate frames.
5. **Data** – transmitted payload.
6. **CRC** – 32-bit checksum for error detection.

[**Direct link to heading**](802.11-and-auth.md#id-802.11-frame-types) **802.11 Frame Types**

1. **Management (00)** – manages connections (beaconing, authentication).
2. **Control (01)** – regulates data frame transmission.
3. **Data (10)** – carries actual payload.

[**Direct link to heading**](802.11-and-auth.md#management-frame-subtypes) **Management Frame Subtypes**

Key for Wi-Fi pentesting:

* **Beacon (1000)** – AP advertises SSID, ciphers, and rates.
* **Probe Request/Response (0100 / 0101)** – client discovers AP; AP responds with info.
* **Authentication Request/Response (1011)** – client identifies itself to AP.
* **Association/Reassociation Request & Response (0000–0011)** – client requests connection; AP accepts or rejects.
* **Disassociation/Deauthentication (1010 / 1100)** – terminates connection; includes reason code.

[**Direct link to heading**](802.11-and-auth.md#connection-cycle-wpa2-example) **Connection Cycle (WPA2 Example)**

1. **Beacon frames** – AP announces itself.
2. **Probe request/response** – client discovers AP.
3. **Authentication request/response** – client authenticates.
4. **Association request/response** – client connects.
5. **Handshake (EAPOL)** – key exchange for security.
6. **Disassociation/Deauthentication** – connection termination.

**Wireshark Filters Examples:**

* Beacon: `(wlan.fc.type == 0) && (wlan.fc.type_subtype == 8)`
* Probe Request: `(wlan.fc.type == 0) && (wlan.fc.type_subtype == 4)`
* Probe Response: `(wlan.fc.type == 0) && (wlan.fc.type_subtype == 5)`
* Authentication: `(wlan.fc.type == 0) && (wlan.fc.type_subtype == 11)`
* Association Request: `(wlan.fc.type == 0) && (wlan.fc.type_subtype == 0)`
* Association Response: `(wlan.fc.type == 0) && (wlan.fc.type_subtype == 1)`
* EAPOL handshake: `eapol`
* Disassociation/Deauth: `(wlan.fc.type == 0) && (wlan.fc.type_subtype == 10 or 12)`

### [Direct link to heading](802.11-and-auth.md#auth) Auth

[**Direct link to heading**](802.11-and-auth.md#wi-fi-authentication-methods) **Wi-Fi Authentication Methods**

Wi-Fi networks primarily use **two authentication systems**:

1. **Open System Authentication (OSA)**

* No credentials or shared key required.
* Used in **public or guest networks**.
* **Process:**

1. Client → AP: Authentication Request
2. AP → Client: Authentication Response
3. Client → AP: Association Request
4. AP → Client: Association Response

* Simple and convenient but **no security**.

2. **Shared Key Authentication (SKA)**

* Requires a **pre-shared key (PSK)** or other shared secret.
* Adds a **security layer** by verifying both client and AP.
* Common in **WEP, WPA, WPA2, WPA3**.

[**Direct link to heading**](802.11-and-auth.md#shared-key-methods) **Shared Key Methods**

Method

Key/Authentication

Encryption

Security

WEP

PSK

RC4 + CRC-32

Weak

WPA

PSK / 802.1x

TKIP + MIC

Strong

WPA2

PSK / 802.1x

AES + CCMP

Stronger

WPA3

SAE (instead of PSK)

AES + CCM

Strongest

[**Direct link to heading**](802.11-and-auth.md#authentication-flows) **Authentication Flows**

**WEP (Shared Key) Flow:**

1. Client → AP: Authentication Request
2. AP → Client: Challenge Text
3. Client → AP: Encrypted Challenge Response
4. AP → Client: Success / Failure

**WPA / WPA2 Flow (Four-Way Handshake):**

1. Client → AP: Authentication Request
2. AP → Client: Authentication Response
3. **Pairwise Key Generation:** PMK derived from PSK
4. **Four-Way Handshake:** Nonce exchange, verification, session key setup

**WPA3:**

* Uses **SAE (Simultaneous Authentication of Equals)** instead of PSK.
* Stronger protection against brute force attacks and individual session compromise.
* Adoption is slower due to hardware limitations.

[PreviousWireless](security/offensive-security/wireless/) [NextHidden SSIDs](hidden-ssids.md)

Last updated 12 days ago
