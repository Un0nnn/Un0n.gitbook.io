# DOM XSS

## Basics

[DOM](https://www.w3schools.com/js/js_htmldom.asp) XSS is non-persistent, and completely processed on client-side through JS. Document Object Model (DOM) changes the page source through JS.

To confirm DOM XSS, look in the Network tab to see if any request is made after inputting payload. Also, if input parameter in URL is using a #, it means its a client-side parameter (never reaches back-end).

#### Source & Sink

Source is any input or URL parameter or input field, that takes a user input, while Sink is a function that writes the input to a DOM Object on the page.

If a Sink function does not properly sanitize the user input it would be vulnerable to XSS.

<details>

<summary>Commonly used JS functions to write to DOM Objects</summary>

DOM.innerHTML

DOM.outerHTML

document.write

</details>

#### Searching for DOM XSS (Example)

{% code title="In search.js, the page extracts user input directly from the URL parameter 'q'" %}
```javascript
var start = document.URL.indexOf("q=");
var query = document.URL.substring(start + 2, document.URL.length);
```
{% endcode %}

{% code title="After reading the input, it writes using an unsafe Sink function (innerHTML)" %}
```javascript
document.getElementById("results").innerHTML =
    "<p>You searched for: " + decodeURIComponent(query) + "</p>";
```
{% endcode %}

Depending on the function, we can research which payloads would bypass the function as inner.HTML does not allow.

> This is non-persistent. So to target a specific user would have to send the user a URL containing the payload/parameters (GET). For POST there are other techniques.
