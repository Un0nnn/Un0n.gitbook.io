# DOM XSS

[DOM](https://www.w3schools.com/js/js_htmldom.asp) XSS is non-persistent, and completely processed on client-side through JS. Document Object Model (DOM) changes the page source through JS.

To confirm DOM XSS, look in the Network tab to see if any request is made after inputting payload. Also, if input parameter in URL is using a #, it means its a client-side parameter (never reaches back-end).

### [Direct link to heading](dom-xss.md#source-and-sink) Source & Sink

Source is any input or URL parameter or input field, that takes a user input, while Sink is a function that writes the input to a DOM Object on the page.

If a Sink function does not properly sanitize the user input it would be vulnerable to XSS.

Commonly used JS functions to write to DOM Objects [Direct link to heading](dom-xss.md#commonly-used-js-functions-to-write-to-dom-objects)

DOM.innerHTML

DOM.outerHTML

document.write

### [Direct link to heading](dom-xss.md#searching-for-dom-xss-example) Searching for DOM XSS (Example)

In search.js, the page extracts user input directly from the URL parameter 'q'

Copy

```
var start = document.URL.indexOf("q=");
var query = document.URL.substring(start + 2, document.URL.length);
```

After reading the input, it writes using an unsafe Sink function (innerHTML)

Copy

```
document.getElementById("results").innerHTML =
    "<p>You searched for: " + decodeURIComponent(query) + "</p>";
```

Depending on the function, we can research which payloads would bypass the function as inner.HTML does not allow.

> This is non-persistent. So to target a specific user would have to send the user a URL containing the payload/parameters (GET). For POST there are other techniques.

[PreviousReflected XSS](reflected-xss.md) [NextBlind XSS](blind-xss.md)

Last updated 4 days ago
